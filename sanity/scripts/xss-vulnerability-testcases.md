# XSS Vulnerability Test Cases for PrismJS

This document outlines test cases for verifying that XSS vulnerabilities in PrismJS have been properly addressed.

## Test Case 1: Basic XSS Attempt

**Input:**
```html
<script>alert("XSS")</script>
```

**Expected Output:**
- HTML entities should be escaped: `&lt;script&gt;alert("XSS")&lt;/script&gt;`
- No executable JavaScript should be rendered

## Test Case 2: Event Handler Injection

**Input:**
```html
<div onmouseover="alert('XSS')">Hover me</div>
```

**Expected Output:**
- Event handlers should be neutralized or stripped
- Output should contain `onmouseover` as text, not as an event attribute

## Test Case 3: JavaScript Protocol in URLs

**Input:**
```html
<a href="javascript:alert('XSS')">Click me</a>
```

**Expected Output:**
- JavaScript protocol should be neutralized
- Link should not execute JavaScript when clicked

## Test Case 4: Data URI Injection

**Input:**
```html
<img src="data:image/svg+xml;base64,PHN2ZyBvbmxvYWQ9ImFsZXJ0KDEpIj48L3N2Zz4=">
```

**Expected Output:**
- Data URIs should be properly sanitized
- No script execution should occur

## Test Case 5: CSS Expression Injection

**Input:**
```html
<div style="background-image: expression(alert('XSS'))">CSS XSS</div>
```

**Expected Output:**
- CSS expressions should be neutralized
- No script execution should occur

## Test Case 6: Large Code Block Performance

**Input:**
- Very large code block (10,000+ characters)

**Expected Behavior:**
- Syntax highlighting should complete in a reasonable time
- Browser should remain responsive
- DOM detachment technique should be used for performance

## Implementation Guide

To mitigate these vulnerabilities:

1. Use DOMPurify to sanitize input before processing
2. Implement proper HTML entity escaping
3. Use the DOM detachment technique for large code blocks
4. Validate input types before processing
5. Disable dangerous Prism plugins

All test cases have been verified as of May 15, 2025.
